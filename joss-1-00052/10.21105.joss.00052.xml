<?xml version="1.0" encoding="utf-8" ?>
<article>
  <articleinfo>
    <title>fuse: An R package for ensemble Hydrological Modelling</title>
    <authors>
      <author>
        <name>Claudia Vitolo</name>
        <orcid>0000-0002-4252-1176</orcid>
        <affiliation>
          <orgname>
            1
          </orgname>
        </affiliation>
      </author>
      <author>
        <name>Peter Wells</name>
        <affiliation>
          <orgname>
            2
          </orgname>
        </affiliation>
      </author>
      <author>
        <name>Martin Dobias</name>
        <affiliation>
          <orgname>
            2
          </orgname>
        </affiliation>
      </author>
      <author>
        <name>Wouter Buytaert</name>
        <orcid>0000-0001-6994-4454</orcid>
        <affiliation>
          <orgname>
            1
          </orgname>
        </affiliation>
      </author>
    </authors>
    <tags>
      <tag>hydrological modelling</tag>
      <tag>R</tag>
    </tags>
    <date>6 September 2016</date>
    <paper_doi>10.21105/joss.00052</paper_doi>
    <software_repository>https://github.com/cvitolo/fuse</software_repository>
    <software_archive>http://dx.doi.org/10.5281/zenodo.212822</software_archive>
    <paper_url>https://github.com/openjournals/joss-papers/blob/master/joss.00052/10.21105.joss.00052.pdf</paper_url>
  </articleinfo>
  <body>
    <h1 id="summary">Summary</h1>
    <p>Fuse <span class="citation">(C. Vitolo et al. 2012)</span> is an R package <span class="citation">(R Core Team 2016)</span> that implements the framework for hydrological modelling FUSE <span class="citation">(Clark et al. 2008)</span> and based on the Fortran code kindly provided by Martyn Clark in 2011. The package consists of two modules: the soil moisture accounting module (fusesma.sim) and the gamma routing module (fuserouting.sim).</p>
    <p>The fuse framework takes as input rainfall and potential evapotranspiration time series (areal averages over the river catchment area) and returns a simulated time series of river discharges. It can be used to understand the variability of expected hydrological responses based on model structures.</p>
    <p>The package contains default parameter ranges (fusesma.ranges and fuserouting.ranges) and three data objects: fuse_hydrological_timeseries (sample input dataset), parameters (sample parameters) and modlist (list of FUSE model structures).</p>
    <p>An early version of this package was used as modelling backend of web applications for the Environmental Virtual Observatory pilot project<span class="citation">(C. Vitolo et al. 2015,<span class="citation">Wilkinson et al. (2015)</span>)</span>.</p>
    <p>The fuse package could in future be submitted to CRAN and included in the Task View dedicated to Analysis of Ecological and Environmental Data (Envirometrics). This already includes a number of packages for hydrological modelling such as <span class="citation">(Buytaert 2011)</span>, <span class="citation">(Metcalfe, Beven, and Freer 2016)</span> and <span class="citation">(Reusser and Francke 2011)</span>. These packages only implement a single model structures,while fuse would complement them providing a framework for ensemble modelling. The package hydromad <span class="citation">(Andrews, Croke, and Jakeman 2011)</span> also implements ensemble modelling but it is not currently on CRAN.</p>
    <p>A new version of the fuse Fortran code was recently released on <a href="https://github.com/naddor/fuse">GitHub</a>. Fortran users are advised to refer to this latest version of fuse. This package is not an interface for the latest Fortran code but any contribution in this direction is welcome.</p>
    <h1 id="references" class="unnumbered">References</h1>
    <div id="refs" class="references">
    <div id="ref-Andrews20111171">
    <p>Andrews, F.T., B.F.W. Croke, and A.J. Jakeman. 2011. “An Open Software Environment for Hydrological Model Assessment and Development.” <em>Environmental Modelling &amp; Software</em> 26 (10): 1171–85. doi:<a href="https://doi.org/http://dx.doi.org/10.1016/j.envsoft.2011.04.006">http://dx.doi.org/10.1016/j.envsoft.2011.04.006</a>.</p>
    </div>
    <div id="ref-topmodel">
    <p>Buytaert, Wouter. 2011. <em>Topmodel: Implementation of the Hydrological Model Topmodel in R</em>. <a href="https://CRAN.R-project.org/package=topmodel" class="uri">https://CRAN.R-project.org/package=topmodel</a>.</p>
    </div>
    <div id="ref-Clark2008">
    <p>Clark, Martyn P., Andrew G. Slater, David E. Rupp, Ross A. Woods, Jasper A. Vrugt, Hoshin V. Gupta, Thorsten Wagener, and Lauren E. Hay. 2008. “Framework for Understanding Structural Errors (Fuse): A Modular Framework to Diagnose Differences Between Hydrological Models.” <em>Water Resour. Res</em> 44 (W00B02). doi:<a href="https://doi.org/10.1029/2007WR006735">10.1029/2007WR006735</a>.</p>
    </div>
    <div id="ref-dynatopmodel">
    <p>Metcalfe, Peter, Keith Beven, and Jim Freer. 2016. <em>Dynatopmodel: Implementation of the Dynamic Topmodel Hydrological Model</em>. <a href="https://CRAN.R-project.org/package=dynatopmodel" class="uri">https://CRAN.R-project.org/package=dynatopmodel</a>.</p>
    </div>
    <div id="ref-R-base">
    <p>R Core Team. 2016. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/" class="uri">https://www.R-project.org/</a>.</p>
    </div>
    <div id="ref-wasim">
    <p>Reusser, Dominik, and Till Francke. 2011. <em>Wasim: Visualisation and Analysis of Output Files of the Hydrological Model Wasim</em>. <a href="https://CRAN.R-project.org/package=wasim" class="uri">https://CRAN.R-project.org/package=wasim</a>.</p>
    </div>
    <div id="ref-Vitolo2015185">
    <p>Vitolo, Claudia, Yehia Elkhatib, Dominik Reusser, Christopher J.A. Macleod, and Wouter Buytaert. 2015. “Web Technologies for Environmental Big Data.” <em>Environmental Modelling &amp; Software</em> 63: 185–98. doi:<a href="https://doi.org/http://dx.doi.org/10.1016/j.envsoft.2014.10.007">http://dx.doi.org/10.1016/j.envsoft.2014.10.007</a>.</p>
    </div>
    <div id="ref-fuse-archive">
    <p>Vitolo, Claudia, Peter Wells, Martin Dobias, and Wouter Buytaert. 2012. <em>Fuse: Framework for Understanding Structural Errors, R Package Version 3.1</em>. doi:<a href="https://doi.org/10.5281/zenodo.61639">10.5281/zenodo.61639</a>.</p>
    </div>
    <div id="ref-Wilkinson201538">
    <p>Wilkinson, M.E., E. Mackay, P.F. Quinn, M. Stutter, K.J. Beven, C.J.A. MacLeod, M.G. Macklin, et al. 2015. “A Cloud Based Tool for Knowledge Exchange on Local Scale Flood Risk.” <em>Journal of Environmental Management</em> 161: 38–50. doi:<a href="https://doi.org/http://dx.doi.org/10.1016/j.jenvman.2015.06.009">http://dx.doi.org/10.1016/j.jenvman.2015.06.009</a>.</p>
    </div>
    </div>
  </body>
</article>
