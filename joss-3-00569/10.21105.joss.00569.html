body = <<-EOF
<meta name="citation_title" content="<code>ChebTools</code>: C++11 (and Python) tools for working with Chebyshev expansions">
<meta name="citation_author" content="H. Bell, Ian"><meta name="citation_author" content="Alpert, Bradley"><meta name="citation_author" content="Bouck, Lucas">
<meta name="citation_publication_date" content="2018//">
<meta name="citation_journal_title" content="The Journal of Open Source Software">
<meta name="citation_pdf_url" content="http://www.theoj.org/joss-papers/joss.00569/10.21105.joss.00569.pdf">
<meta name="citation_doi" content="10.21105/joss.00569">
<meta name="citation_issn" content="2475-9066">
<div class="accepted-paper">
  <h1><code>ChebTools</code>: C++11 (and Python) tools for working with Chebyshev expansions</h1>
  <div class="columns links">
    <div class="column four-fifths" style="padding-bottom: 10px;">
      <strong>Authors</strong>
      <ul class="author-list">
            <li><a href="http://orcid.org/0000-0003-1091-9080" target="_blank">Ian H. Bell</a></li>
            <li><a href="http://orcid.org/0000-0001-9765-9642" target="_blank">Bradley Alpert</a></li>
            <li><a href="http://orcid.org/0000-0001-7723-0427" target="_blank">Lucas Bouck</a></li>
            </ul>
    </div>
    <div class="one-third column">
      <span class="repo">Repository:<br /><a href="https://github.com/usnistgov/ChebTools">Repository link &raquo;</a></span>
    </div>
    <div class="one-third column">
      <span class="paper">Paper:<br /><a href="http://www.theoj.org/joss-papers/joss.00569/10.21105.joss.00569.pdf">PDF link &raquo;</a></span>
    </div>
    <div class="one-third column">
      <span class="paper">Review:<br /><a href="https://github.com/openjournals/joss-reviews/issues/569">View review issue &raquo;</a></span>
    </div>

    <div class="one-third column" style="padding-top: 20px;">
      <span class="repo">DOI:<br /><a href="https://doi.org/10.21105/joss.00569">https://doi.org/10.21105/joss.00569</a></span>
    </div>
    <div class="one-third column" style="padding-top: 20px;">
      <span class="paper">Status badge:<br /><img src="http://joss.theoj.org/papers/10.21105/joss.00569/status.svg"></span>
    </div>
    <div class="one-third column" style="padding-top: 20px;">
      <span class="paper">
        Submitted: 29 January 2018 <br />
        Published: 12 February 2018
      </span>

    </div>
    <div class="two-thirds column" style="padding-top: 20px;">
      <span class="paper">Citation:<br />
      <small>Bell et al., (2018). ChebTools: C++11 (and Python) tools for working with Chebyshev expansions. <em>Journal of Open Source Software</em>, 3(22), 569. https://doi.org/10.21105/joss.00569</small>
    </div>
  </div>
  <div class="paper-body">
  <h1 id="summary">Summary</h1>
  <p>Chebyshev-basis expansions, and more broadly, orthogonal polynomial expansions, are commonly used as numerical approximations of continuous functions on closed domains <span class="citation" data-cites="Boyd-SIAM-2013">(Boyd 2013,<span class="citation" data-cites="Mason-BOOK-2003">Mason and Handscomb (2003)</span>,<span class="citation" data-cites="Battles-SJSC-2004">Battles and Trefethen (2004)</span>)</span>. One of the most successful projects that makes use of the Chebyshev expansions is the <code>chebfun</code> library <span class="citation" data-cites="chebfun">(Driscoll, Hale, and Trefethen 2014)</span> for MATLAB. Other similar libraries are <code>pychebfun</code><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, <code>chebpy</code><a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>, and <code>Approxfun</code><a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>. Our library <code>ChebTools</code> fills a similar niche as that of <code>chebfun</code> &#8211; working with Chebyshev expansions.</p>
  <p>The primary motivation for the development of <code>ChebTools</code> is the need for a highly optimized and fast C++11 library for working with Chebyshev expansions in order to do one-dimensional rootfinding from nonlinear functions of multiple variables that arise out of thermodynamic modeling (equations of state of multiple state variables). A manuscript on this topic is forthcoming that builds off the tools developed in <code>ChebTools</code>.</p>
  <p>Internally, the header-only library <code>Eigen</code><a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> is used to carry out all the matrix operations, allowing for behind-the-scenes vectorization without any user intervention. Thus the library is also very computationally efficient.</p>
  <p>A short list of the capabilities of <code>ChebTools</code> is as follows:</p>
  <ul>
  <li>Construct a Chebyshev expansion approximation of any one-dimensional function in an arbitrary closed domain.</li>
  <li>Apply numerical operators on expansions : addition, subtraction, multiplication, arbitrary mathematical functions.</li>
  <li>Find all roots of the function.</li>
  <li>Calculate the derivative of the expansion.</li>
  </ul>
  <p>While C++11 allows for the development of very computationally-efficient code, users often prefer a higher-level interface. As such, a comprehensive one-to-one Python wrapper of <code>ChebTools</code> was developed through the use of the pybind11<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> library(<span class="citation" data-cites="pybind11">Jakob, Rhinelander, and Moldovan (2016)</span>). This library offers the capability to natively integrate C++11 and Python - it is, for instance, trivial to pass Python functions to C++ functions accepting C++11 <code>std::function</code> (for use as a callback, or here, as the function sampled to generate the expansion).</p>
  <p>We provide a <code>jupyter</code> notebook <span class="citation" data-cites="Perez2007">(P&#233;rez and Granger 2007)</span> mirroring much of the example code from Battles and Trefethen <span class="citation" data-cites="Battles-SJSC-2004">(2004)</span> and <code>pychebfun</code>. Furthermore, a binder<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> environment has been configured such that ChebTools can be explored in an online jupyter notebook without installing anything on the user&#8217;s computer.</p>
  <p>In this Python code block, we demonstrate finding the roots and extrema of the 0-th Bessel function in the closed domain [0, 30]:</p>
  <div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="im">import</span> scipy.special</a>
  <a class="sourceLine" id="cb1-2" data-line-number="2"><span class="im">import</span> ChebTools</a>
  <a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co"># Only keep the roots that are in [-1,1] in scaled coordinates</span></a>
  <a class="sourceLine" id="cb1-4" data-line-number="4">only_in_domain <span class="op">=</span> <span class="va">True</span></a>
  <a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co"># The 0-th Bessel function (for code concision)</span></a>
  <a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">def</span> J0(x): <span class="cf">return</span> scipy.special.jn(<span class="dv">0</span>,x)</a>
  <a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co"># Make a 200-th order expansion of the 0-th Bessel function in [0,30]</span></a>
  <a class="sourceLine" id="cb1-8" data-line-number="8">f <span class="op">=</span> ChebTools.generate_Chebyshev_expansion(<span class="dv">200</span>, J0, <span class="dv">0</span>, <span class="dv">30</span>)</a>
  <a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co"># Roots of the function</span></a>
  <a class="sourceLine" id="cb1-10" data-line-number="10">rts <span class="op">=</span> f.real_roots(only_in_domain)</a>
  <a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co"># Extrema of the function (roots of the derivative, where dy/dx =0)</span></a>
  <a class="sourceLine" id="cb1-12" data-line-number="12">extrema <span class="op">=</span> f.deriv(<span class="dv">1</span>).real_roots(only_in_domain)</a></code></pre></div>
  <p>A graphical representation of the roots and extrema of the 0-th Bessel function in the closed domain [0, 30] is shown in the <code>jupyter</code> notebook in the repository and is also displayed here:</p>
  <figure>
  <img src="Bessel.png" alt="Roots and extrema of the 0-th Bessel function" /><figcaption>Roots and extrema of the 0-th Bessel function</figcaption>
  </figure>
  <h1 id="disclaimer">Disclaimer</h1>
  <p>Contribution of the National Institute of Standards and Technology, not subject to copyright in the U.S. Commercial equipment, instruments, or materials are identified only in order to adequately specify certain procedures. In no case does such identification imply recommendation or endorsement by the National Institute of Standards and Technology, nor does it imply that the products identified are necessarily the best available for the purpose.</p>
  <h1 id="references" class="unnumbered">References</h1>
  <div id="refs" class="references">
  <div id="ref-Battles-SJSC-2004">
  <p>Battles, Z., and L.N. Trefethen. 2004. &#8220;An Extension of MATLAB to Continuous Functions and Operators.&#8221; <em>SIAM J. Sci. Comput.</em> 25 (5):1743&#8211;70. <a href="https://doi.org/10.1137/S1064827503430126" class="uri">https://doi.org/10.1137/S1064827503430126</a>.</p>
  </div>
  <div id="ref-Boyd-SIAM-2013">
  <p>Boyd, J.P. 2013. &#8220;Finding the Zeros of a Univariate Equation: Proxy Rootfinders, Chebyshev Interpolation, and the Companion Matrix.&#8221; <em>SIAM Review</em> 55 (2):375&#8211;96. <a href="https://doi.org/10.1137/110838297" class="uri">https://doi.org/10.1137/110838297</a>.</p>
  </div>
  <div id="ref-chebfun">
  <p>Driscoll, T.A., N. Hale, and L.N. Trefethen. 2014. &#8220;Chebfun Guide.&#8221; Oxford: Pafnuty Publications.</p>
  </div>
  <div id="ref-pybind11">
  <p>Jakob, W., J. Rhinelander, and D. Moldovan. 2016. &#8220;Pybind11 &#8211; Seamless Operability Between C++11 and Python.&#8221;</p>
  </div>
  <div id="ref-Mason-BOOK-2003">
  <p>Mason, J.C., and D.C. Handscomb. 2003. <em>Chebyshev Polynomials</em>. Boca Raton: Chapman &amp; Hall.</p>
  </div>
  <div id="ref-Perez2007">
  <p>P&#233;rez, F., and B. E. Granger. 2007. &#8220;IPython: A System for Interactive Scientific Computing.&#8221; <em>Computing in Science and Engineering</em> 9 (3). IEEE Computer Society:21&#8211;29. <a href="https://doi.org/10.1109/MCSE.2007.53" class="uri">https://doi.org/10.1109/MCSE.2007.53</a>.</p>
  </div>
  </div>
  <section class="footnotes">
  <hr />
  <ol>
  <li id="fn1"><p>https://github.com/pychebfun<a href="#fnref1" class="footnote-back">&#8617;</a></p></li>
  <li id="fn2"><p>https://github.com/chebpy/chebpy<a href="#fnref2" class="footnote-back">&#8617;</a></p></li>
  <li id="fn3"><p>https://github.com/JuliaApproximation/ApproxFun.jl<a href="#fnref3" class="footnote-back">&#8617;</a></p></li>
  <li id="fn4"><p>http://eigen.tuxfamily.org<a href="#fnref4" class="footnote-back">&#8617;</a></p></li>
  <li id="fn5"><p>https://github.com/pybind/pybind11<a href="#fnref5" class="footnote-back">&#8617;</a></p></li>
  <li id="fn6"><p>https://mybinder.org/<a href="#fnref6" class="footnote-back">&#8617;</a></p></li>
  </ol>
  </section>
  </div>
</div>
EOF
