<?xml version="1.0" encoding="utf-8" ?>
<article>
  <articleinfo>
    <title>Kindel: indel-aware consensus for nucleotide sequence alignments</title>
    <authors>
      <author>
        <name>Bede Constantinides</name>
        <orcid>0000-0002-3480-3819</orcid>
        <affiliation>
          <orgname>
            1
          </orgname>
        </affiliation>
      </author>
      <author>
        <name>David L. Robertson</name>
        <orcid>0000-0001-6338-0221</orcid>
        <affiliation>
          <orgname>
            2
          </orgname>
        </affiliation>
      </author>
    </authors>
    <tags>
      <tag>bioinformatics</tag>
      <tag>sequence analysis</tag>
      <tag>genome assembly</tag>
    </tags>
    <date>26 May 2017</date>
    <paper_doi>10.21105/joss.00282</paper_doi>
    <software_repository>https://github.com/bede/kindel</software_repository>
    <software_archive>http://dx.doi.org/10.5281/zenodo.826723</software_archive>
    <paper_url>https://github.com/openjournals/joss-papers/raw/master/joss.00282/10.21105.joss.00282.pdf</paper_url>
  </articleinfo>
  <body>
    <h1 id="summary">Summary</h1>
    <p>Kindel is a collection of tools for inferring consensus sequence from an alignment of nucleotide sequences in Sequence Alignment/Map (SAM) format <span class="citation">(Li et al. 2009)</span> in the presence of substitutions, insertions and deletions (indels). At regions where reads deviate sufficiently from the reference sequence, partially unaligned sequence context is used to perform local reassembly. In this way, Kindel generates a data-specific reference sequence that maximises overall read-reference similarity. While an elegant streaming approach to consensus inference was implemented in OCOCO <span class="citation">(Břinda, Boeva, and Kucherov 2016)</span>, like other approaches it fails to reconcile indels.</p>
    <p>Kindel was developed for inferring consensus of highly diverse populations of RNA viruses such as hepatitis C and HIV, and is tested with deep sequenced hepatitis C alignments generated by BWA-MEM <span class="citation">(Li and Durbin 2009)</span> and Segemehl <span class="citation">(Otto, Stadler, and Hoffmann 2014)</span>. Furthermore, Kindel may be used to quantify and visualise subconsensus variation in allele frequencies across a reference sequence, facilitating comparison of intrapatient population state among multiple individuals and/or timepoints. Kindel is implemented as a Python 3 package with a command line interface.</p>
    <div class="figure">
    <img src="kindelflow.png" alt="Usage overview." />
    <p class="caption">Usage overview.</p>
    </div>
    <div class="figure">
    <img src="cdrs.png" alt="Local reassembly of clip-dominant regions (CDRs). Leveraging partially aligned reads, consensus can be accurately inferred across unrepresentative and poorly covered regions of reference sequence." />
    <p class="caption">Local reassembly of clip-dominant regions (CDRs). Leveraging partially aligned reads, consensus can be accurately inferred across unrepresentative and poorly covered regions of reference sequence.</p>
    </div>
    <h1 id="references" class="unnumbered">References</h1>
    <div id="refs" class="references">
    <div id="ref-ococo">
    <p>Břinda, Karel, Valentina Boeva, and Gregory Kucherov. 2016. “Dynamic read mapping and online consensus calling for better variant detection,” 1–21. <a href="http://arxiv.org/abs/1605.09070" class="uri">http://arxiv.org/abs/1605.09070</a>.</p>
    </div>
    <div id="ref-bwa">
    <p>Li, Heng, and Richard Durbin. 2009. “Fast and Accurate Short Read Alignment with Burrows–Wheeler Transform.” <em>Bioinformatics</em> 25 (14): 1754. doi:<a href="https://doi.org/10.1093/bioinformatics/btp324">10.1093/bioinformatics/btp324</a>.</p>
    </div>
    <div id="ref-samtools">
    <p>Li, Heng, Bob Handsaker, Alec Wysoker, Tim Fennell, Jue Ruan, Nils Homer, Gabor Marth, Goncalo Abecasis, and Richard Durbin. 2009. “The Sequence Alignment/Map Format and Samtools.” <em>Bioinformatics</em> 25 (16): 2078. doi:<a href="https://doi.org/10.1093/bioinformatics/btp352">10.1093/bioinformatics/btp352</a>.</p>
    </div>
    <div id="ref-segemehl">
    <p>Otto, Christian, Peter F. Stadler, and Steve Hoffmann. 2014. “Lacking Alignments? The Next-Generation Sequencing Mapper Segemehl Revisited.” <em>Bioinformatics</em> 30 (13): 1837. doi:<a href="https://doi.org/10.1093/bioinformatics/btu146">10.1093/bioinformatics/btu146</a>.</p>
    </div>
    </div>
  </body>
</article>
